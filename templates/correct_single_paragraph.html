<!DOCTYPE html>
<html>
<header>
    <style>
      div {
        display: table;
      }
      div div {
        #display: table-row;
      }
      div div label, div div input {
        display: table-cell;
        margin-bottom: 20px;
        margin-right: 20px;
      }
      div div input {
        margin-left: 10px;
      
      }
      .center {
        display: flex;
        justify-content: center;
        align-items: center;
        height: 50px;
        /*border: 3px solid green;*/
      }

    </style>
</header>
<body>
    <h1>Correction du paragraphe</h1>
    <div class="searchBox">
        <div>
          <label for="lessonNb">Numéro de leçon:</label>
          <input type="number" id="lessonNb" name="lessonNb" min="1" max="100"/>
          <label for="lineNb">Numéro de ligne:</label>
          <input type="number" id="lineNb" name="lineNb" min="1" max="30"/>
        </div>
        <div class="center">
            <button onclick="proceedSearch()">Rechercher</button>
        </div>
        </div>
    <div>
        <div>
            <label for="paragraph">Paragraphe:</label>
            <input type="text" id="paragraph" name="paragraph" size="100"/>
        </div>
        <div>
            <label for="translation">Traduction:</label>
            <input type="text" id="translation" name="translation" size="100"/>
        </div>
        <div class="center">
            <button onclick="storeChanges()">Enregistrer</button>
        </div>
    </div>
    <div id="div01"></div>

    <script>

        function setParagraph(data) {
            console.log(data);
            entry = JSON.parse(data)
            console.log("paragraph :", entry['paragraph'])
            paragraph = document.getElementById("paragraph");
            paragraph.value = entry["paragraph"];

            translation = document.getElementById("translation");
            translation.value = entry["translation"];
        }

        function clearParagraph() {
            paragraph = document.getElementById("paragraph");
            paragraph.value = "";

            translation = document.getElementById("translation");
            translation.value = "";

        }

        function proceedSearch() {
            let lessonNb = document.getElementById("lessonNb").value;
            let lineNb = document.getElementById("lineNb").value;

            console.log(lessonNb, lineNb)
            item = {
                "lesson_nb" : lessonNb,
                "line_nb" : lineNb,
           }

            var itemString = JSON.stringify(item);

            fetch('/fetch-stored-paragraph/',  {
               method: 'POST',
               headers: {
                 'Accept': 'application/json',
                 'Content-Type': 'application/json'
               },
               body: itemString,
              })
              .then(resp => resp.text())  // or, resp.json(), etc.
              .then(data => {
                setParagraph(data)
              })
              .catch(error => {
              console.error(error);
            });
        }

        function storeChanges() {
            let lessonNb = document.getElementById("lessonNb").value;
            let lineNb = document.getElementById("lineNb").value;
            let paragraph = document.getElementById("paragraph").value;
            let translation = document.getElementById("translation").value;

            let item = {
                "lesson_nb" : lessonNb,
                "line_nb" : lineNb,
                "paragraph" : paragraph,
                "translation" : translation,
            }

            var itemString = JSON.stringify(item);

            fetch('/store-paragraph-changes/',  {
               method: 'POST',
               headers: {
                 'Accept': 'application/json',
                 'Content-Type': 'application/json'
               },
               body: itemString,
              })
              .then(resp => resp.text())  // or, resp.json(), etc.
              .then(data => {
                clearParagraph();
              })
              .catch(error => {
              console.error(error);
            });



        }
    </script>
</body>
</html>